<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>PostMessage를 보내는 쪽</title>

    <script src="main.js"></script>

    <script>
        var childwin;
        const childname = "popup";

        function openChild() {
            childwin = window.open('page2.html', childname, 'height=300px, width=500px');
        }

        function sendMessage() {
            let msg = {
                pName: "Bob",
                pAge: "35"
            };
            // childwin.postMessage(msg);
            // childwin.focus();
        }

        function send2SW() {
            let msg = {
                command: "print",
                sentence: "Hello Service Worker!",
                url: "'https://sistinalove.github.io/SWtesting/sw.js'",
                type: "push",
                push: "https://www.google.com",
                action : "preview",
                payload : {
                    title : "제발 되면 좋겠다",
                    body : "오늘 안에는 해결이 될까?"
                }
            };

            // 서비스 워커가 있으면 DOM -> SW로 MSG 보내기
            if (navigator.serviceWorker.controller) {
                navigator.serviceWorker.controller.postMessage(msg);
            }
        }
    </script>
</head>

<body>
    <h1>postMessage Test</h1>
    <h3> Done by Yeomin J </h3>

    <form>
        <fieldset>
            <input type="button" id='btnopen' value="Open child" onclick="openChild();">
            <input type="button" id='btnSendMsg' value="Send Message" onclick="sendMessage(); send2SW();">

        </fieldset>
    </form>


    <!--Subscriber.com의 구독 정보-->
    <!-- <script type="text/javascript">
        var subscribersSiteId = '78185a89-75a0-456f-b23e-df9c40c1eb30';
    </script>
    <script type="text/javascript" src="https://cdn.subscribers.com/assets/subscribers.js"></script> -->

</body>

</html>